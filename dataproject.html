---
layout: infographic
---
<script src="https://d3js.org/d3.v4.min.js"></script>
<!-- <a href="/img/nathan-draft-1.png">draft 1</a> -->

<div class="container">

<section id="mainTitle">
  <div class="centeredText">
    <h1>Why do we sleep alone?</h1>
    <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque euismod facilisis augue ac varius. Nulla vitae ligula augue. Nam cursus mattis ante vitae tempor. Donec nec eleifend urna. Suspendisse faucibus faucibus rutrum. Etiam ultricies enim quis faucibus tristique.</p>
  </div>
</section>

<section id="pieChartSection">
  <svg id="pieChartSVG" class= width=100% height=600>
    <g id="bracket-left" stroke-width="1" fill="none" transform="translate(250, 25)">
        <path d="M68.0866323,0 C68.0866323,0 -22.6893793,33.0076325 5.73250231,150.578697 C34.1543839,268.149762 -4.97379915e-14,268.284861 -4.97379915e-14,268.284861" id="Path-2" stroke="#4A4A4A" stroke-width="2"></path>
        <path d="M68.0866323,538.284861 C68.0866323,538.284861 -22.6893793,505.277228 5.73250231,387.706163 C34.1543839,270.135098 4.97379915e-14,270 4.97379915e-14,270" id="Path-2" stroke="#4A4A4A" stroke-width="2"></path>
    </g>
    <text x="122" y="300" font-family="American Typewriter" font-size="20px" fill="black">Sleeps alone</text>

    <g id="bracket-right" stroke-width="1" fill="none" transform="translate(920, 295) rotate(-180.000000) translate(-235.500000, -269.500000) translate(201.000000, 0.000000)">
        <path d="M68.0866323,0 C68.0866323,0 -22.6893793,33.0076325 5.73250231,150.578697 C34.1543839,268.149762 -4.97379915e-14,268.284861 -4.97379915e-14,268.284861" id="Path-2" stroke="#4A4A4A" stroke-width="2"></path>
        <path d="M68.0866323,538.284861 C68.0866323,538.284861 -22.6893793,505.277228 5.73250231,387.706163 C34.1543839,270.135098 4.97379915e-14,270 4.97379915e-14,270" id="Path-2" stroke="#4A4A4A" stroke-width="2"></path>
    </g>
    <text x="960" y="300" font-family="American Typewriter" font-size="20px" fill="black">Never sleeps alone</text>
  </svg>
</section>


<section id="dotChartSection">
  <div class="text-container">
    <h2 id="dotChartTitle">When do people start sleeping alone, does it improve sex life?</h2>
    <p id="dotChartP" class="small-p">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque euismod facilisis augue ac varius. Nulla vitae ligula augue. Nam cursus mattis ante vitae tempor. Donec nec eleifend urna. Suspendisse faucibus faucibus rutrum. Etiam ultricies enim quis faucibus tristique.</p>
    <button class="dotChartBtn" id="sexBtn">Sex Life</button>
    <button class="dotChartBtn" id="relationshipBtn">Relationship</button>
  </div>
  <svg id="dotChartSVG" class="" width=100% height=600></svg>
</section>

<section id="circleChartSection">
  <h2 id="dotChartTitle">When do people start sleeping alone, does it improve sex life?</h2>
  <p id="dotChartP" class="small-p">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Pellentesque euismod facilisis augue ac varius. Nulla vitae ligula augue. Nam cursus mattis ante vitae tempor. Donec nec eleifend urna. Suspendisse faucibus faucibus rutrum. Etiam ultricies enim quis faucibus tristique.</p>
  <svg id="circleChartSVG" class="" width=100% height=600></svg>
</section>



</div>




<script>

//rStatus
//rLength
//separateBeds
//sleepLocation
//sleepLocationOther
//sleepLocationPartner
//sleepLocationPartnerOther
//separateReason0
//separateReason1
//separateReason2
//separateReason3
//separateReason4
//separateReason5
//separateReason6
//separateReason7
//separateReason8
//separateReason9
//firstSeperateBed
//stayingTogether
//sleepBetterSeperate
//sexImproved
//occupation
//occupationOther
//gender
//age
//income
//education
//location

d3.csv("data/sleeping-alone-data.csv", function(error, data){
  //console.log(error, file);
                          // data, index
  data = data.filter(function(d, i) {
    return i != 0; // D3 automatically makes the 1st row in a CSV file the headers, so when you call the first row it is technically the second row in the data set. in the case of java that means to call the "first row" i would actually call 0
  });


  console.log(" ");
  console.log("-----------------------------------------------------------------------------");
  console.log("How often people sleep separately");
  console.log("-----------------------------------------------------------------------------");

  // Returns information about how often people sleep separately
  var separateBedData = d3.nest()
    .key(function(d, i, key){
      return d.separateBeds;
    })
    .entries(data);

  separateBedData = separateBedData.filter(function(d, i){
    return d.key != ""; // dont return people who didn't answer the question
  });

  separateBedData.forEach(function(d, i) {
    var amount = d.values.length;
    console.log(separateBedData[i].key + " " + amount);
  });


  var div = d3.select("#pieChartSection").append("div").attr("class", "toolTip");



  var arc = d3.arc()
      .outerRadius(300 - 10)
      .innerRadius(0);

  var pieData = d3.pie().value(function(d){
    return d.values.length
  })(separateBedData);

  var color = d3.scaleOrdinal()
    // .domain(["Hi, there, I, am, bob, crack"])
    .range(["#6BA4E7", "#8CB8ED", "#50E3C2", "#ADCDF2", "#DEEBFA", "#4A90E2", "#4A90E2"]);

  var pieGroup = d3.select("#pieChartSVG")
    .append("g")
    .attr("transform", "translate(" + 600 + "," + 600 / 2 + ")");

  var pieSlices = pieGroup.selectAll("path").data(pieData);

  pieSlices.enter().append("path")
    .attr("d", arc)
    .style("fill", function(d, i  ) {
      return color(d.data.key);
    });



    // var pieLabel = d3.select("#pieChartSVG")
    //   .append("text")
    //   .attr("transform", "translate(" + 0 + "," + 0 + ")");

    // var text = pieLabel.selectAll("text").data(pieData)
    // .enter()
    // .append("text")
    // .text("test");

    // var textLabels = text
    // .text("test");

  console.log(pieData);


  console.log(" ");
  console.log("-----------------------------------------------------------------------------");
  console.log("When people started to sleep alone");
  console.log("-----------------------------------------------------------------------------");

  // Returns information about when people started to sleep separately, grouped by Gender
  var firstSeperateBedData = d3.nest()
    .key(function(d, i, key){
      return d.gender + " " + d.firstSeperateBed })
    .entries(data);

  firstSeperateBedData = firstSeperateBedData.filter(function(d, i){
    return d.key != ""; // dont return people who didn't include a gender
  });

  firstSeperateBedData.forEach(function(d,i){
    var x = firstSeperateBedData[i].values.length;
    console.log(firstSeperateBedData[i].key + " " + x);
    // console.log(x);
  });


  console.log(" ");
  console.log("-----------------------------------------------------------------------------");
  console.log("Relationship improved");
  console.log("-----------------------------------------------------------------------------");

  var relationshipImprove = d3.nest()
        .key(function(d, i, key){
          return d.gender + " " + d.firstSeperateBed + " " + d.stayingTogether })
          .entries(data);

  relationshipImprove.forEach(function(d,i){
    var x = relationshipImprove[i].values.length;
    console.log(relationshipImprove[i].key + " " + x);
    // console.log(x);
  });


  console.log(" ");
  console.log("-----------------------------------------------------------------------------");
  console.log("Sex life improved");
  console.log("-----------------------------------------------------------------------------");


  var sexImproved = d3.nest()
        .key(function(d, i, key){
          return d.gender + " " + d.firstSeperateBed + " " + d.sexImproved })
          .entries(data);

  sexImproved.forEach(function(d,i){
    var x = sexImproved[i].values.length;
    console.log(sexImproved[i].key + " " + x);
    // console.log(x);
  });

  // var relationshipImprove = d3.nest()
  //       .key(function(d, i, key){
  //         return d.gender + " " + d.firstSeperateBed })
  //       .key(function(d, i){
  //         return d.stayingTogether
  //       })
  //       .key(function(d, i){
  //         return d.sexImproved
  //       })
  //         .entries(data);
  //
  // relationshipImprove.forEach(function(d,i){
  //   var x = relationshipImprove[i].values.length;
  //   // console.log(relationshipImprove[i].key + " " + x);
  //   // console.log(x);
  // });

// console.log(relationshipImprove);

console.log(" ");
console.log("-----------------------------------------------------------------------------");
console.log("Reasons for sleeping separately");
console.log("-----------------------------------------------------------------------------");



var reasons = d3.nest()
      .key(function(d, i){
        return d.gender})
      .entries(data);

var reasonsMale = reasons[0].values;
var reasonsFemale = reasons[1].values;

var malesWhoAnswered1 = reasonsMale.filter(function(maleObject) {
  return !maleObject.separateReason0 === '';
});
var numMalesWhoAnswered0 = malesWhoAnswered1.length;



// generate a key for each "separate reason"
function generateKeys(string, count) {
  var result = [];
  for (i = 0; i < count; i++) {
    result[i] = string + i;
  }
  return result;
}

var reasonKeys = generateKeys('separateReason', 10);

// filters each seperateReason and returns the number or people who responded
function calcNumResponses(key, array) {
  var filteredArray = array.filter(function(arrayEntry) {
    return arrayEntry[key] !== '';
  });
  return filteredArray.length;
}

// takes the array of keys and the array of objects and maps the number of
// responses to the array of keys
function getReasonCounts(keysArray, reasonsArray) {
  return keysArray.map(function(key) {
    return calcNumResponses(key, reasonsArray);
  })
};

console.log(getReasonCounts(reasonKeys, reasonsMale));
console.log(getReasonCounts(reasonKeys, reasonsFemale));




  // var menByLocation = nestedData[0].values.map(function(obj) {
  //   var newObj = {
  //     location: obj.key,
  //     people: obj.values.length
  //   };
  //   return newObj;
  // });

//   console.log(nestedData[0].values.filter(function(d, i){
//     return d.key == "Pacific";
//   })[0].values.length, pacificMenLength
// );






// var genderDraw = function(data){
//   var svg = d3.select("svg");
//   var circles = svg.selectAll("circle").data(data);
//   var genderData = d3.extent(data, function(d, i){
//     return d.values.length;
//   });
//   var radius = d3.scaleLinear();
//   console.log(genderData);
//
//   circles.enter().append("circle")
//     .attr("cy", 60)
//     .attr("cx", function(d, i){
//       return 60 + (120 * i);
//     })
//     .attr("r", function(d, i){
//       return (radius(d.values.length) / 10);
//     });
// };
//
// var locationDraw = function(data){
//   var svg = d3.select("svg");
//   var circles = svg.selectAll("circle").data(data);
//   var locationData = d3.extent(data, function(d, i){
//     return d.values.length
//   });
// };






//   var maleLocations = [];
//   var femaleLocations = [];
//   var maleMountains = 0;
//   var femaleMountains = 0;
//
//  // var test = nestedData.values.filter(function(d, i){
//  //   return d.key == "Mountain";
//  // });
//
//   for (var i = 0; i < nestedData[0].values.length; i++){
//     maleLocations.push(nestedData[0].values[i].location);
//     if (nestedData[0].values[i].location == "Mountain") {
//       maleMountains++;
//     }
//   };
//
// // Make an array
//   for (var i = 0; i < nestedData[1].values.length; i++){
//     femaleLocations.push(nestedData[1].values[i].location);
//     if (nestedData[1].values[i].location == "Mountain") {
//       femaleMountains++;
//     }
//   };
//
//
//   // console.log(test);
//   console.log(femaleLocations);
//   console.log(maleLocations);
//   console.log("Males who live in mountain regions: " + maleMountains);
//   console.log("Females who live in mountain regions: " + femaleMountains);

  // genderDraw(nestedData);
});

</script>
